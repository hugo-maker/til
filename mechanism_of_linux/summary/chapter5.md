# Chapter5

メモリ管理システム
- メモリ管理システムとは: Linuxにおいて、システムに搭載されている全メモリを管理しているカーネルの機能。
- メモリ使用量が増え、空きメモリが減少すると、カーネル内のメモリ領域を解放。
- OOMとは: カーネル内の解放可能領域がなくなるとOOM(Out Of Memory)状態となり、メモリが足りず身動きが取れなくなる。
- OOM killerとは: OOM状態になると、適当なプロセスを選んで強制終了することによってメモリ領域を解放する。

仮想記憶
- 仮想記憶とは: システムに搭載されているメモリに対して、プロセスから直接アクセスさせず、仮想アドレスを用いて間接的にアクセスさせる機能。
- 仮想アドレス: プロセス側から見えているメモリのアドレス⇔物理アドレス: システム搭載のメモリの実際のアドレス
- 単純なメモリ割当てが抱える問題点(メモリフラグメンテーションの発生、データ破壊、マルチプロセスの扱いの難しさ)を解決する。

- メモリフラグメンテーション→ページテーブルの設定により解消。
- データ破壊→仮想アドレス空間はプロセスごとに作られ、ページテーブルもプロセスごとに作られるため、そもそも他のプロセスのメモリへアクセス不可。カーネルのメモリは、全プロセスの仮想アドレス空間から見えてはいるものの、カーネルのメモリにアクセスできるのはカーネルのみであるため、問題なし。
- マルチプロセス→仮想アドレス空間は、プロセスごとに独立なため、問題なし。

ページテーブル
- ページテーブルとは: 仮想アドレスと物理アドレスを対応づけるために用いるデータ構造。
- ページフォールトとは: 物理アドレスに紐付いていない仮想アドレスにアクセスしようとすると発生する割り込み。
- ページフォールトハンドラとは: 実行中の命令がページフォールトによって中断された後に動く、カーネル内の処理。プロセスによるメモリアクセスが不正なものであることを検出し、SIGSEGVというシグナルでプロセスに通知する。通常、通知を受けたプロセスは強制終了させられる。

上位レイヤからの呼び出し
- C言語の標準ライブラリのmalloc()関数は、Linuxにおいては、内部的にmmap()関数を呼び出している。
- Python等のスクリプト言語においては、各オブジェクトの作成につき、最終的には内部でC言語のmalloc(),mmap()を呼び出している。(処理系がC言語プログラム)

ファイルマップ
- ファイルマップとは: ファイル領域を仮想アドレス空間にマップする機能。

デマンドページング
- デマンドページングとは: プロセスの仮想アドレス空間内の各ページに対応する物理メモリを、そのページに最初にアクセスした際に初めて割り当てる方法。
- 仮想メモリを確保した、とは: プロセスがmmap()関数などによってメモリを確保すること。
- 物理メモリを確保した、とは: 確保した仮想メモリにアクセスして(デマンドページングにより)物理メモリに紐付けられること。
